
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Overview &#8212; Navtools 2021.06.01 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Navigation Calculations Module" href="navigation.html" />
    <link rel="prev" title="NavTools 2021.06" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>The essential story is this:</p>
<blockquote>
<div><p>“As skipper of sailing vessel <em>Red Ranger</em>,
I need to create detailed voyage plans with distance,
bearing, and estimated time of arrival to each mark or waypoint.”</p>
</div></blockquote>
<p>To put this story into context, we have a number of tools
for voyage planning, execution and analysis. This software fills
an essential gap among those tools. We’ll look at the three areas
separately.</p>
<p><strong>Planning</strong>.
Voyage planning involves locating courses that avoid navigational hazards
and make use of the available Aids to Navigation (ATONs).  In some cases,
tide and current are accounted for, as well as adverse weather.</p>
<p>For route planning, S/V <em>Red Ranger</em> carries three copies of the NOAA charts.</p>
<ul class="simple">
<li><p>Paper charts.  A mixture of old and new.</p></li>
<li><p>The Jeppesen C-Map charts (<a class="reference external" href="http://www.c-map.com/">http://www.c-map.com/</a>) on an
electronic chart plotter.</p></li>
<li><p>Several copies of and GPSNavX (<a class="reference external" href="http://www.gpsnavx.com/">http://www.gpsnavx.com/</a>) and iNavX with the latest charts
downloaded  from NOAA.  (<a class="reference external" href="http://www.charts.noaa.gov/RNCs/RNCs.shtml">http://www.charts.noaa.gov/RNCs/RNCs.shtml</a>)</p></li>
</ul>
<p>It’s not simple to sketch a route on an electronic chart and transform this into
a schedule for sailing. Trying to do this is likely to introduce transcription errors.</p>
<p>There are numerous piloting techniques that apply to paper charts,
but the electronic chart support for these techniques is sketchy.</p>
<p>It would be better to do planning in a way that doesn’t involve manual transcriptions.</p>
<p><strong>Execution</strong>.
For sailing a particular voyage, S/V <em>Red Ranger</em> carries several ways of assuring
that she is on course.</p>
<ul class="simple">
<li><p>Crew observation of the ATONs, landmarks, and seascape.</p></li>
<li><p>Paper charts and standard piloting techniques like dead reckoning,
lines of position and course lines.</p></li>
<li><p>Electronic Chartplotter in the cockpit.
(Standard Horizon <a class="reference external" href="http://www.standardhorizon.com/indexVS.cfm?cmd=DisplayProducts&amp;ProdCatID=84&amp;encProdID=491E084FB06B41812BEEF96C77A4A8E2&amp;DivisionID=3&amp;isArchived=1">CP180i</a>)</p></li>
<li><p>GPSNavX on a MacBook Pro with its own GPS antenna (entirely separate from
the chartplotter). (<a class="reference external" href="http://www.gpsnavx.com">http://www.gpsnavx.com</a>)</p></li>
<li><p>iNavX on a iPhones and iPad (<a class="reference external" href="http://www.inavx.com">http://www.inavx.com</a>).
This uses a separate Dual XGPS 150 antenna (<a class="reference external" href="http://gps.dualav.com/explore-by-product/xgps150a/">http://gps.dualav.com/explore-by-product/xgps150a/</a>).</p></li>
</ul>
<p>All this tells where S/V <em>Red Ranger</em> is.
The important gap here is in contingency planning: knowing where
S/V <em>Red Ranger</em> should be.
Will she arrive on time?  Do we need to change course, or
use the auxiliary engine?  Do we need to look for an alternate
route or anchorage?</p>
<blockquote>
<div><p><em>“The most dangerous piece of equipment is the calendar.
The issue here is not maintaining a schedule, but sailing
safely during daylight hours and leaving enough time to
locate an anchorage before dark.”</em></p>
</div></blockquote>
<p>The cockpit chartplotter provides an Estimated Time of Arrival (ETA)
to a specific waypoint based on current
course and speed.  It fails to provide any <em>planned</em> ETA to that waypoint that
serves as basis for comparison.</p>
<p><strong>Analysis</strong>.
Logging is done several ways.</p>
<ul class="simple">
<li><p>Electronic Chartplotter in the cockpit can record a track.  Currently,
this is difficult to upload from the chartplotter.</p></li>
<li><p>OpenCPN on a MacBook Pro with its own GPS antenna.
This means finding a way to secure a computer and leave it running
to accumulate a track. This is not currently feasible on <em>Red Ranger</em>:
there’s no way to secure the computer or provide power.</p></li>
<li><p>iNavX on an iPhone or iPad with a separate GPS antenna.  This also requires
leaving the phone running.  The track can be extracted through
The X-Traverse web site.</p></li>
<li><p>Paper logging of heading, speed, wind and engine for each sail change,
tack and each hour. This is currently how track analysis is handled.</p></li>
</ul>
<p>There are no tools for retrospective analysis of logs at all.</p>
</section>
<section id="actors">
<h1>Actors<a class="headerlink" href="#actors" title="Permalink to this headline">¶</a></h1>
<p>The primary actor for the use cases is the skipper of S/V <em>Red Ranger</em>.</p>
<p>Crew members may participate in the Execution.  However,
the ultimate responsibility lies with the skipper.</p>
<p>Voyage planning can be forwarded to shore crew as a kind of <strong>Float Plan</strong>.
Using SPOT Satellite communications, we can provide actual positions so
that the shore crew can compare positions against the voyage plan.</p>
</section>
<section id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h1>
<p>There are four broad use cases</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id3">Execution Use Case</a></p></li>
<li><p><a class="reference internal" href="#planning-use-case">Planning Use Case</a></p></li>
<li><p><a class="reference internal" href="#float-plan-use-case">Float Plan Use Case</a></p></li>
<li><p><a class="reference internal" href="#analysis-use-case">Analysis Use Case</a></p></li>
</ul>
<section id="execution-use-case">
<h2>Execution Use Case<a class="headerlink" href="#execution-use-case" title="Permalink to this headline">¶</a></h2>
<p>Consider a sample sailing story.</p>
<ol class="arabic simple">
<li><p>Actors depart their slip for a destination that involves <span class="math notranslate nohighlight">\(n &gt; 2\)</span>
waypoints.</p></li>
<li><p>System (cockpit chart plotter) shows ETA to waypoint 1.  Actors arrive
at waypoint 1, switch system to waypoint 2.</p></li>
<li><p>System shows ETA to waypoint 2.  Actors arrive
at waypoint 2, switch system to waypoint 3.</p></li>
<li><p>System shows ETA to waypoint 3.  Actors realize that arrival time is
now unsafe (i.e., after dark).</p></li>
</ol>
<p>At waypoint 1 – due to adverse wind or currents – <em>Red Ranger</em>
could have been behind the overall schedule, and the actors needed to know this
before setting course for waypoint 2.</p>
<p>This means that waypoint-by-waypoint planned ETA’s are required for safe
execution of a schedule. The skipper can then compare planned ETA’s with actual
ETA’s to determine if contingency plans should be executed.</p>
</section>
<section id="planning-use-case">
<h2>Planning Use Case<a class="headerlink" href="#planning-use-case" title="Permalink to this headline">¶</a></h2>
<p>The overall planning use case creates a
a waypoint-by-waypoint schedule or “Voyage Track”.
See Bowditch <a class="reference internal" href="#bowditch" id="id1"><span>[bowditch]</span></a>, section 2508, Constructing a Voyage Track.
Also, see Bowditch <a class="reference internal" href="#bowditch" id="id2"><span>[bowditch]</span></a>, section 802 for more information on planning.</p>
<dl class="citation">
<dt class="label" id="bowditch"><span class="brackets">bowditch</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id4">3</a>)</span></dt>
<dd><p>THE AMERICAN PRACTICAL NAVIGATOR.  <a class="reference external" href="http://www.irbs.com/bowditch/">http://www.irbs.com/bowditch/</a>
Also <a class="reference external" href="http://msi.nga.mil/MSISiteContent/StaticFiles/NAV_PUBS/APN/pub9.zip">http://msi.nga.mil/MSISiteContent/StaticFiles/NAV_PUBS/APN/pub9.zip</a></p>
</dd>
</dl>
<ol class="arabic simple">
<li><p>Actor plans the route in general.  This is a separate use
case, outside the scope of this document.  System saves
the route as a list of waypoints.</p></li>
<li><p>Actor runs the “route_planning” application.  The system
creates a “schedule” file with the waypoints plus
additional information like distance to next waypoint,
bearing of next waypoint, and ETA.</p></li>
<li><p>Actor runs a spreadsheet application (Open Office Org, for example),
and imports the schedule file.  This is a separate use
case, outside the scope of this document.
The system prints the resulting schedule or downloads it to an iPad.</p></li>
</ol>
<p>The actor can cycle through this use case to create alternatives
and contingency plans.</p>
</section>
<section id="float-plan-use-case">
<h2>Float Plan Use Case<a class="headerlink" href="#float-plan-use-case" title="Permalink to this headline">¶</a></h2>
<p>This involves two extensions to the <a class="reference internal" href="#planning-use-case">Planning Use Case</a> and <span class="target" id="id3">Execution Use Case</span>.</p>
<ul>
<li><p>Instead of merely printing or saving the plan for their own use,
the skipper merges the plan with a description of the vessel and crew.
This merged document becomes a float plan that can be sent to trusted
on-shore people to act as a check-list against periodic notification.</p>
<p><em>Red Ranger</em> uses a Spot Tracker (<a class="reference external" href="http://findmespot.com/en/">http://findmespot.com/en/</a>). A noon email
is sent to confirm progress. An email could be sent for each waypoint,
in addition to a noon position.</p>
</li>
</ul>
</section>
<section id="analysis-use-case">
<h2>Analysis Use Case<a class="headerlink" href="#analysis-use-case" title="Permalink to this headline">¶</a></h2>
<p>In retrospect, a track may be analyzed to compute actual distance
run (and times of arrival).  This can be compared with the plan to
improve the quality of the planning process.</p>
<p>The essential feature is analysis of the track created by the
GPS chartplotter (or computer) during sailing.</p>
<ol class="arabic simple">
<li><p>Actor extracts the track from the GPS chartplotter.  This is a separate use
case, outside the scope of this document.  System saves
the track as a list of positions and times.</p></li>
<li><p>Actor runs the “track_analysis” application.  The system
creates a file with the track position plus
additional information like distance to next position,
cumulative time and cumulative distance.</p></li>
<li><p>Actor runs a spreadsheet application (Open Office Org, for example),
and imports the track file.  This is a separate use
case, outside the scope of this document.
The actor can then do additional analysis on these results.</p></li>
</ol>
</section>
</section>
<section id="solution-overview">
<h1>Solution Overview<a class="headerlink" href="#solution-overview" title="Permalink to this headline">¶</a></h1>
<p>The core planning software is OpenCPN (formerly GPSNavX) on an iMac.
This application can export a route file in GPX or CSV notation.</p>
<p>These GPX or CSV files can be imported and parsed by a Python application,
which can use a set of navigation calculations to compute
range, bearing, time for each leg.  It can also compute
an accumulated time and accumulated distance.</p>
<p>The Python application can emit CSV files for use in other desktop tools.
A spreadsheet can be used to print
a paper schedule is used for cockpit decision-making.
The actual time of arrival (ATA) to each waypoint can be logged.
The gap between ETA and ATA supports a number of sailing decisions.</p>
<p>A spreadsheet can be emailed to support a float plan. And a spreadsheet
can be used for retrospective analysis of voyages.</p>
<section id="data-interface">
<h2>Data Interface<a class="headerlink" href="#data-interface" title="Permalink to this headline">¶</a></h2>
<p>The application reads GPX or CSV files and writes a CSV file.</p>
<p>It relies on an additional configuration parameter:
the anticipated speed of the boat on each leg of the course.  Ideally,
this is part of the GPX route.  GPXNavX, however, doesn’t seem
to have an easy way to enter it.</p>
<p>Further, in a sailboat, a default value is the only thing
that makes sense.  Because of the hull speed of displacement
hulls (like S/V <em>Red Ranger</em>) there are further constraints.</p>
<p><span class="math notranslate nohighlight">\(1.34\times\sqrt{LWL}\)</span> is the maximum hull speed.
A more useful default sailing  speed is 5 kn.</p>
<p>An additional configuration detail is the magnetic compass deviation.
This varies from location to location around the planet, and also
with the date on which the trip is made. We can compute this using
the IGRF module.</p>
<p>Additional inputs could include details from the serial interface.
A USB GPS antenna (Like the <a class="reference external" href="http://usglobalsat.com/p-688-bu-353-s4.aspx#images/product/large/688.jpg">BU-535</a>) can be read via PySerial.</p>
</section>
<section id="user-interface">
<h2>User Interface<a class="headerlink" href="#user-interface" title="Permalink to this headline">¶</a></h2>
<p>The application is essentially a simple “filter”.
Consistent with the <strong>*nix</strong> philosophy, the
interface is a simple CLI that reads a file or standard input.</p>
<p>Here’s a concept of how this might be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">navtools</span><span class="o">.</span><span class="n">planning</span> <span class="n">my_trip</span><span class="o">.</span><span class="n">gpx</span>
</pre></div>
</div>
<p>This creates a <code class="file docutils literal notranslate"><span class="pre">my_trip</span> <span class="pre">Schedule.csv</span></code> file with the schedule
calculations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">navtools</span><span class="o">.</span><span class="n">analysis</span> <span class="n">some_log</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>This creates a <code class="file docutils literal notranslate"><span class="pre">some_log</span> <span class="pre">Distance.csv</span></code> file with the distance
and speed calculation.</p>
</section>
</section>
<section id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<p>There are several layers to this application.</p>
<ol class="arabic simple">
<li><p>Fundamental Navigation Calculations.  These are the domain
objects and functions. This includes GPS coordinates, range and bearing
calculations.  It also includes compass deviation calculations.</p></li>
<li><p>The GPX or CSV input parsing.  This will create Navigation
objects from the input file.  These objects can then be transformed
into the output CSV file.</p></li>
<li><p>The “main” applications.  Each of these opens a file, acquires the
input route, uses the navigation calculations, and creates
the output schedule or analysis.</p></li>
<li><p>The CLI overheads.</p></li>
</ol>
<p>Based on the potential for reusability, we can package these
layers into several modules.</p>
</section>
<section id="consequences">
<h1>Consequences<a class="headerlink" href="#consequences" title="Permalink to this headline">¶</a></h1>
<p>This application is not “plugged into” OpenCPN or iNavX.  Consequently, planning
involves multiple steps with multiple tools.  A route is created, the ETA’s examined, and
waypaints added to handle overnight anchorages.
Any change to a waypoint means the schedule must be recalculated.</p>
<p>A tool like <code class="docutils literal notranslate"><span class="pre">scons</span></code> can be used to “automate” creation of the
schedule from the <code class="file docutils literal notranslate"><span class="pre">.GPX</span></code> file.  Even this is not <em>totally</em> automated,
since someone has to remember to regenerate the schedule after
modifying the route.</p>
<p>Additional annotations that should be included on the paper chart
(like ATON details, for example) aren’t present in this schedule.
The details aren’t in the GPX file, and can’t easily be located.</p>
<p>To an extent, the online light list <a class="reference external" href="http://www.navcen.uscg.gov/?pageName=lightLists">http://www.navcen.uscg.gov/?pageName=lightLists</a>
could be consulted to provide waypoint information.  Locating the lights
passed along the track as well as lights near each waypoint is challenging.</p>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference internal" href="#bowditch" id="id4"><span>[bowditch]</span></a> Chapters 21 and 22.</p>
<p>See <a class="reference external" href="http://www.ngdc.noaa.gov/IAGA/vmod/igrf.html">http://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</a> for information on the
magnetic declination.</p>
<p>The International Union of Geodesy and Geophysics (IUGG) defines mean radius values.
This is used to convert angles to distances.</p>
<p>GPX format is described here: <a class="reference external" href="http://www.topografix.com/gpx.asp">http://www.topografix.com/gpx.asp</a></p>
<p>Here’s the official GPX schema: <a class="reference external" href="http://www.topografix.com/GPX/1/1/">http://www.topografix.com/GPX/1/1/</a></p>
<p>See <a class="reference external" href="http://williams.best.vwh.net/avform.htm">http://williams.best.vwh.net/avform.htm</a></p>
<p>See <a class="reference external" href="http://www.movable-type.co.uk/scripts/latlong.html">http://www.movable-type.co.uk/scripts/latlong.html</a>, © 2002-2010 Chris Veness</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Navtools</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#actors">Actors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#use-cases">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#execution-use-case">Execution Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#planning-use-case">Planning Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#float-plan-use-case">Float Plan Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis-use-case">Analysis Use Case</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#solution-overview">Solution Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-interface">Data Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-interface">User Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="#consequences">Consequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="#references">References</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="navigation.html">Navigation Calculations Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning.html">Route Planning Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Track Analysis Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="igrf11.html">International Geomagnetic Reference Field Module</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">NavTools 2021.06</a></li>
      <li>Next: <a href="navigation.html" title="next chapter">Navigation Calculations Module</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, S.Lott.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/introduction.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>